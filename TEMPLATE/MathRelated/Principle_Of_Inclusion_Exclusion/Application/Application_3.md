#

## 最大公约数为 k 的数对个数

**问题描述**

设 $1 \le x,y \le N$ ，$f(k)$ 表示最大公约数为 $k$ 的有序数对 $(x,y)$ 的个数，求 $f(1)$ 到 $f(N)$ 的值。

同样按照上面 `容斥原理` 的过程分析 :

1. 全集 `U` : 公约数有 `k` 的 全部有序数对 `(x,y)` 的集合
2. `Si` : 最大公约数为 `i * k` 的有序数对 `(x,y)` 的集合 , 那么我们等价于就是求 `S1`
3. 得到关系式 :
   $$U = S_1 \cup S_2 \cup ... \cup S_{N/k}$$
   又因为对于任意 $k$ 有 : $S_{a_1} \cap S_{a_2} \cap ... \cap S_{a_k} = \empty$ , 所以 :
   $$U = S_1 + S_2 + ... + S_{N/k}$$
4. 所以 $S_1 = U - S_2 - S_3 - ... - S_{N/k}$
5. 那么我们从 N 往前进行计算即可

**代码参考**

```cpp
const int N = 1e5 + 7;
long long f[N];
for(long long i = N;i;i --) {
    // 全集 U :
    // cnt = N / i
    // U = cnt * cnt
    f[i] = (N / i) * (N / i);
    for(long long j = i + i;j <= N;j += i) {
        f[i] -= f[j];
    }
}
// 复杂度 : O(NlogN)
```

---

**例题**

代码全部看 `../Problem/` 中对应题号代码


**题目一 : [P2398 GCD SUM](https://www.luogu.com.cn/problem/P2398)**

**题目描述**

求

$$\sum_{i=1}^n \sum_{j=1}^n \gcd(i, j)$$

**输入格式**

第一行一个整数 $n$。

**输出格式**

第一行一个整数表示答案。


**提示**

对于 $30\%$ 的数据，$n\leq 3000$。

对于 $60\%$ 的数据，$7000\leq n\leq 7100$。

对于 $100\%$ 的数据，$n\leq 10^5$。

---

**题目二 : [P2158 [SDOI2008] 仪仗队](https://www.luogu.com.cn/problem/P2158)**

**题目描述**

作为体育委员，C 君负责这次运动会仪仗队的训练。仪仗队是由学生组成的 $N \times N$ 的方阵，为了保证队伍在行进中整齐划一，C 君会跟在仪仗队的左后方，根据其视线所及的学生人数来判断队伍是否整齐（如下图）。

![](https://cdn.luogu.com.cn/upload/pic/1149.png)

现在，C 君希望你告诉他队伍整齐时能看到的学生人数。

**输入格式**

一行，一个正整数 $N$。

**输出格式**

输出一行一个数，即 C 君应看到的学生人数。

**样例**

**样例输入**

```
4
```

**样例输出**

```
9
```

**提示**

对于 $100 \%$ 的数据，$1 \le N \le 40000$。

---

**题目三 : [P1447 [NOI2010] 能量采集](https://www.luogu.com.cn/problem/P1447)**

**题目描述**

栋栋有一块长方形的地，他在地上种了一种能量植物，这种植物可以采集太阳光的能量。在这些植物采集能量后，栋栋再使用一个能量汇集机器把这些植物采集到的能量汇集到一起。

栋栋的植物种得非常整齐，一共有 $n$ 列，每列有 $m$ 棵，植物的横竖间距都一样，因此对于每一棵植物，栋栋可以用一个坐标 $(x, y)$ 来表示，其中 $x$ 的范围是 $1$ 至 $n$，$y$ 的范围是 $1$ 至 $m$，表示是在第 $x$ 列的第 $y$ 棵。

由于能量汇集机器较大，不便移动，栋栋将它放在了一个角上，坐标正好是 $(0, 0)$。

能量汇集机器在汇集的过程中有一定的能量损失。如果一棵植物与能量汇集机器连接而成的线段上有 $k$ 棵植物，则能量的损失为 $2k + 1$。例如，当能量汇集机器收集坐标为 $(2, 4)$ 的植物时，由于连接线段上存在一棵植物 $(1, 2)$，会产生 $3$ 的能量损失。注意，如果一棵植物与能量汇集机器连接的线段上没有植物，则能量损失为 $1$。现在要计算总的能量损失。

下面给出了一个能量采集的例子，其中 $n = 5$，$m = 4$，一共有 $20$ 棵植物，在每棵植物上标明了能量汇集机器收集它的能量时产生的能量损失。

![](https://cdn.luogu.com.cn/upload/pic/2608.png) 

在这个例子中，总共产生了 $36$ 的能量损失。

**输入格式**

一行两个整数 $n,m$。

**输出格式**

仅包含一个整数，表示总共产生的能量损失。

**样例**

**样例输入1**

```
5 4
```

**样例输出1**

```
36
```

**样例输入2**

```
3 4
```

**样例输出2**

```
20
```

**提示**

- 对于 $10\%$ 的数据：$n, m \leq 10$；
- 对于 $50\%$ 的数据：$n, m \leq 100$；
- 对于 $80\%$ 的数据：$n, m \leq 10^3$；
- 对于 $90\%$ 的数据：$n, m \leq 10^4$；
- 对于 $100\%$ 的数据：$1 \leq n, m \leq 10^5$。
