#

## 不定方程非负整数解计数

> 不定方程非负整数解计数
> 问题描述 : 

$$x_1 + x_2 + ... + x_n = m , x_i <= b_i , m,bi \in N$$

**问题分析 :**

首先如果没有 $x_i \leq b_i$ 的限制 , 那么该不定方程的 `非负整数解` 的数目为 : $C_{m + n - 1}^{n - 1}$。简略证明 : 相当于 用 `n - 1` 块 `挡板` 来分割 `m` 个小球分成 `n` 块。那么我们可以想成 `m + n - 1` 个连续小球中选择 `n - 1` 个小球来作为 `挡板` 那么选择方案数就是上述的表示。

而现在有了限制 , 我们可以考虑用容斥定理来进行处理 :

1. `全集 U` : 该不定方程的非负整数解
2. `元素` : 变量 $x_i$
3. `属性` : $x_i <= b_i$

`目标` :

$$Target = |S_1 \cap S_1 \cap ... \cap S_n| = |U| - | \overline{{S_1}} \cup \overline{{S_2}} \cup ... \cup \overline{{S_n}}|$$
那么直接根据 `容斥原理` 展开即可。

现在我们来思考如何来求解 : $\overline{{S_i}}$ :

$S_i$ 表示的是解集中满足 $x_i \leq b_i$ 的解集方案集合(此时其他的只需要满足 $x_j \in N$ , $j \neq i$)。
那么 $\overline{{S_i}}$ 表示的是解集中满足 $x_i > b_i$ 的解集方案集合(此时其他的仍然只需要满足 $x_j \in N$ , $j \neq i$)。那么此时我们可以得到 :

$$x_1 + x_2 + ... + x_n = m$$

那么令 $y_i = x_i - b_i - 1$ , $y_i >= 0$ , 得到 :

$$x_1 + x_2 + ... + y_i + ... + x_n = m - b_i - 1$$

那么问题就又转化为了 最开始没有限制的情况 , 那么根据 `组合数` 公式进行求解即可。


**例题 : [P1450 [HAOI2008]硬币购物](https://www.luogu.com.cn/problem/P1450)**

**题目描述**

共有 $4$ 种硬币。面值分别为 $c_1,c_2,c_3,c_4$。

某人去商店买东西，去了 $n$ 次，对于每次购买，他带了 $d_i$ 枚 $i$ 种硬币，想购买 $s$ 的价值的东西。请问每次有多少种付款方法。

**输入格式**

输入的第一行是五个整数，分别代表 $c_1,c_2,c_3,c_4, n$。

接下来 $n$ 行，每行有五个整数，描述一次购买，分别代表 $d_1, d_2, d_3, d_4,s$。

**输出格式**

输出一行数字表示付款的方法数

**样例输入**

```
1 2 5 10 2
3 2 3 1 10
1000 2 2 2 900
```

**样例输出**

```
4
27
```
**数据规模与约定**

* 对于 $100\%$ 的数据，保证 $1 \leq c_i, d_i, s \leq 10^5$，$1 \leq n \leq 1000$。

**解题思路**

那么同样问题就转换为了求解一个 `非负整数的不定方程`

$$c_1 * x_1 + c_2 * x_2 + c_3 * x_3 + c_4 * x_4 = s$$

> 同样按照上面的思路 : 
>
> 那么如果没有个数限制的情况下 , 求全集的方案数 , 可以转化为 `无限背包` 问题来解决 , 那么有个数限制的情况和上述一样用容斥原理来处理即可。

代码具体见 `../Problem/LuoguP1450.cpp`
